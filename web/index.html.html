<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qu·∫£n L√Ω Nh√† Thu·ªëc An Khang</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            color: #333;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: auto;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        h1 {
            text-align: center;
            color: #0056b3;
        }

        h2 {
            border-bottom: 2px solid #0056b3;
            padding-bottom: 10px;
            color: #0056b3;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
        }

        .section {
            background-color: #fdfdfd;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        form {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }

        input, select, textarea {
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 1rem;
        }

        button {
            padding: 10px 15px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #0056b3;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>üíä Qu·∫£n L√Ω Nh√† Thu·ªëc An Khang</h1>

        <div class="grid-container">
            <div class="section">
                <h2>Qu·∫£n l√Ω Danh m·ª•c</h2>
                <form id="add-danhmuc-form">
                    <input type="text" id="madm" placeholder="M√£ danh m·ª•c" required>
                    <input type="text" id="tendm" placeholder="T√™n danh m·ª•c m·ªõi" required>
                    <button type="submit">Th√™m Danh m·ª•c</button>
                </form>
                <table id="danhmuc-table">
                    <thead>
                        <tr>
                            <th>M√£ DM</th>
                            <th>T√™n Danh m·ª•c</th>
                        </tr>
                    </thead>
                    <tbody id="danhmuc-list"></tbody>
                </table>
            </div>

            <div class="section">
                <h2>Qu·∫£n l√Ω Nh√¢n vi√™n</h2>
                <form id="add-nhanvien-form">
                    <input type="text" id="hoten" placeholder="H·ªç t√™n" required>
                    <select id="gt" required>
                        <option value="Nam">Nam</option>
                        <option value="N·ªØ">N·ªØ</option>
                        <option value="Kh√°c">Kh√°c</option>
                    </select>
                    <input type="date" id="ns" placeholder="Ng√†y sinh" required>
                    <input type="date" id="ngayvl" placeholder="Ng√†y v√†o l√†m" required>
                    <button type="submit">Th√™m Nh√¢n vi√™n</button>
                </form>
                 <p><em>(L∆∞u √Ω: Ch·ª©c nƒÉng hi·ªÉn th·ªã danh s√°ch nh√¢n vi√™n c·∫ßn file get_nhanvien.php)</em></p>
            </div>

            <div class="section">
                <h2>Qu·∫£n l√Ω S·∫£n ph·∫©m</h2>
                <form id="add-sanpham-form">
                    <input type="text" id="tensp" placeholder="T√™n s·∫£n ph·∫©m" required>
                    <input type="number" id="giaban" placeholder="Gi√° b√°n" required>
                    <input type="number" id="giamgia-sp" placeholder="Gi·∫£m gi√° (%)" required>
                    <input type="text" id="hinhnsp" placeholder="URL h√¨nh ·∫£nh">
                    <textarea id="congdung" placeholder="C√¥ng d·ª•ng"></textarea>
                    <input type="text" id="xuatsu" placeholder="Xu·∫•t x·ª©">
                    <textarea id="cachdung" placeholder="C√°ch d√πng"></textarea>
                    <input type="number" id="madm-sp" placeholder="M√£ danh m·ª•c (madm)" required>
                    <input type="number" id="madv-sp" placeholder="M√£ ƒë∆°n v·ªã (madv)" required>
                    <button type="submit">Th√™m S·∫£n ph·∫©m</button>
                </form>
                 <p><em>(L∆∞u √Ω: Ch·ª©c nƒÉng hi·ªÉn th·ªã danh s√°ch s·∫£n ph·∫©m c·∫ßn file get_sanpham.php)</em></p>
            </div>

            <div class="section">
                <h2>Qu·∫£n l√Ω ƒê∆°n h√†ng</h2>
                <form id="add-donhang-form">
                    <input type="number" id="giamgia-dh" placeholder="Gi·∫£m gi√° (%)" required>
                    <input type="number" id="manv-dh" placeholder="M√£ nh√¢n vi√™n (manv)" required>
                    <button type="submit">T·∫°o ƒê∆°n h√†ng</button>
                </form>
                <table id="donhang-table">
                    <thead>
                        <tr>
                            <th>S·ªë ƒêH</th>
                            <th>Ng√†y t·∫°o</th>
                            <th>Gi·∫£m gi√° (%)</th>
                            <th>Nh√¢n vi√™n</th>
                        </tr>
                    </thead>
                    <tbody id="donhang-list"></tbody>
                </table>
            </div>

             <div class="section">
                <h2>Qu·∫£n l√Ω Chi ti·∫øt ƒê∆°n h√†ng</h2>
                <form id="add-chitietdh-form">
                    <input type="number" id="sodh-ct" placeholder="S·ªë ƒë∆°n h√†ng (sodh)" required>
                    <input type="number" id="masp-ct" placeholder="M√£ s·∫£n ph·∫©m (masp)" required>
                    <input type="number" id="sl-ct" placeholder="S·ªë l∆∞·ª£ng" required>
                    <input type="number" id="gia-ct" placeholder="Gi√° b√°n" required>
                    <button type="submit">Th√™m v√†o ƒê∆°n h√†ng</button>
                </form>
                <table id="chitietdh-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>S·ªë ƒêH</th>
                            <th>T√™n S·∫£n ph·∫©m</th>
                            <th>S·ªë l∆∞·ª£ng</th>
                            <th>Gi√°</th>
                        </tr>
                    </thead>
                    <tbody id="chitietdh-list"></tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const API_BASE_URL = '../api'; // Th∆∞ m·ª•c ch·ª©a c√°c file PHP

            // H√†m POST d·ªØ li·ªáu chung
            const postData = async (url, data) => {
                try {
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(data)
                    });
                    const result = await response.json();
                    if (result.status === 'success') {
                        alert('Thao t√°c th√†nh c√¥ng!');
                        return true;
                    } else {
                        alert('Thao t√°c th·∫•t b·∫°i!');
                        console.error('L·ªói t·ª´ server:', result);
                        return false;
                    }
                } catch (error) {
                    console.error('L·ªói khi g·ª≠i request:', error);
                    alert('ƒê√£ x·∫£y ra l·ªói. Vui l√≤ng ki·ªÉm tra console.');
                    return false;
                }
            };

            // ---- QU·∫¢N L√ù DANH M·ª§C ----
            const danhmucList = document.getElementById('danhmuc-list');
            const addDanhmucForm = document.getElementById('add-danhmuc-form');

            const loadDanhmuc = async () => {
                const response = await fetch(`${API_BASE_URL}/get_danhmuc.php`);
                const data = await response.json();
                danhmucList.innerHTML = '';
                data.forEach(item => {
                    danhmucList.innerHTML += `<tr><td>${item.madm}</td><td>${item.tendm}</td></tr>`;
                });
            };

            addDanhmucForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const tendm = document.getElementById('tendm').value;
                const success = await postData(`${API_BASE_URL}/post_danhmuc.php`, { tendm });
                if (success) {
                    addDanhmucForm.reset();
                    loadDanhmuc();
                }
            });

            // ---- QU·∫¢N L√ù NH√ÇN VI√äN ----
            const addNhanvienForm = document.getElementById('add-nhanvien-form');
            addNhanvienForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const data = {
                    hoten: document.getElementById('hoten').value,
                    gt: document.getElementById('gt').value,
                    ns: document.getElementById('ns').value,
                    ngayvl: document.getElementById('ngayvl').value
                };
                const success = await postData(`${API_BASE_URL}/post_nhanvien.php`, data);
                if (success) addNhanvienForm.reset();
            });

            // ---- QU·∫¢N L√ù S·∫¢N PH·∫®M ----
            const addSanphamForm = document.getElementById('add-sanpham-form');
            addSanphamForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const data = {
                    tensp: document.getElementById('tensp').value,
                    giaban: parseFloat(document.getElementById('giaban').value),
                    giamgia: parseFloat(document.getElementById('giamgia-sp').value),
                    hinhnsp: document.getElementById('hinhnsp').value,
                    congdung: document.getElementById('congdung').value,
                    xuatsu: document.getElementById('xuatsu').value,
                    cachdung: document.getElementById('cachdung').value,
                    madm: parseInt(document.getElementById('madm-sp').value),
                    madv: parseInt(document.getElementById('madv-sp').value)
                };
                 const success = await postData(`${API_BASE_URL}/post_sanpham.php`, data);
                 if(success) addSanphamForm.reset();
            });

            // ---- QU·∫¢N L√ù ƒê∆†N H√ÄNG ----
            const donhangList = document.getElementById('donhang-list');
            const addDonhangForm = document.getElementById('add-donhang-form');

            const loadDonhang = async () => {
                const response = await fetch(`${API_BASE_URL}/get_donhang.php`);
                const data = await response.json();
                donhangList.innerHTML = '';
                data.forEach(item => {
                    donhangList.innerHTML += `<tr>
                        <td>${item.sodh}</td>
                        <td>${new Date(item.ngaytao).toLocaleString('vi-VN')}</td>
                        <td>${item.giamgia}</td>
                        <td>${item.hoten}</td>
                    </tr>`;
                });
            };

            addDonhangForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const data = {
                    giamgia: parseFloat(document.getElementById('giamgia-dh').value),
                    manv: parseInt(document.getElementById('manv-dh').value)
                };
                const success = await postData(`${API_BASE_URL}/post_donhang.php`, data);
                if (success) {
                    addDonhangForm.reset();
                    loadDonhang();
                }
            });
            
             // ---- QU·∫¢N L√ù CHI TI·∫æT ƒê∆†N H√ÄNG ----
            const chitietdhList = document.getElementById('chitietdh-list');
            const addChitietdhForm = document.getElementById('add-chitietdh-form');

            const loadChitietdh = async () => {
                const response = await fetch(`${API_BASE_URL}/get_chitietdh.php`);
                const data = await response.json();
                chitietdhList.innerHTML = '';
                data.forEach(item => {
                    chitietdhList.innerHTML += `<tr>
                        <td>${item.id}</td>
                        <td>${item.sodh}</td>
                        <td>${item.tensp}</td>
                        <td>${item.sl}</td>
                        <td>${item.gia.toLocaleString('vi-VN')} VNƒê</td>
                    </tr>`;
                });
            };

            addChitietdhForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const data = {
                    sodh: parseInt(document.getElementById('sodh-ct').value),
                    masp: parseInt(document.getElementById('masp-ct').value),
                    sl: parseInt(document.getElementById('sl-ct').value),
                    gia: parseFloat(document.getElementById('gia-ct').value)
                };
                const success = await postData(`${API_BASE_URL}/post_chitietdh.php`, data);
                if (success) {
                    addChitietdhForm.reset();
                    loadChitietdh();
                }
            });

            // T·∫£i d·ªØ li·ªáu ban ƒë·∫ßu khi trang ƒë∆∞·ª£c m·ªü
            loadDanhmuc();
            loadDonhang();
            loadChitietdh();
        });
    </script>

</body>
</html>